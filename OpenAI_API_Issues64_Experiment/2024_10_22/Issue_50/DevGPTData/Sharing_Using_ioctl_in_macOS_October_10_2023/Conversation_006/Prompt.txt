Can you rewrite this code in c++?