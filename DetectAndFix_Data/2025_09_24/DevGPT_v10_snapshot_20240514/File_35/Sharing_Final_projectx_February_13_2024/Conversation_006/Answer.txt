หากต้องการให้ SW1 ส่งค่าเวลาที่ได้รับจาก MQTT broker โดยใช้ค่าที่ได้จากฟังก์ชัน `callback()` ที่รับมาจากการ subscribe topic เกี่ยวกับเวลา (เช่น "@msg/timer/setHr", "@msg/timer/setMinute", "@msg/timer/setSec") แล้วนำค่าเหล่านั้นมาใช้ในการตั้งเวลา โดยให้ SW1 ทำหน้าที่เป็นปุ่มเพื่อเรียกใช้ค่าเวลาที่ได้รับมา เราสามารถทำได้ดังนี้:

1. กำหนดตัวแปร global ไว้เก็บค่าเวลาที่ได้รับมาจาก MQTT broker:

[CODE_BLOCK_0]

2. ในฟังก์ชัน `callback()` ให้เช็คว่าข้อมูลที่รับมาเป็นเกี่ยวกับเวลาหรือไม่ แล้วกำหนดค่าให้ตัวแปร global ตามนั้น:

[CODE_BLOCK_1]

3. ในฟังก์ชัน `checkSwitches()` เมื่อ SW1 ถูกกด ให้ใช้ค่าเวลาที่ได้รับมาจาก MQTT broker:

[CODE_BLOCK_2]

ดังนั้นเมื่อ SW1 ถูกกด ค่าเวลาที่ถูกส่งมาจาก MQTT broker จะถูกนำมาใช้เป็นค่าเวลาที่ต้องการตั้งเพื่อใช้งานครับ