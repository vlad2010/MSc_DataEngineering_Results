can this code be improved?