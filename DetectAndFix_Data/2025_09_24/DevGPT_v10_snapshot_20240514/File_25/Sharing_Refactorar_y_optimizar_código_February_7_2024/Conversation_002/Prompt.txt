Now do it but with significantly more refactoring